<project name="turtle" default="all">

  <property environment="env"/>
  <import file="${env.PONEY_HOME}/poney.xml"/>

  <target name="clean" description="clean intermediate build artifacts">
    <delete dir="${out.dir}"/>
  </target>

  <target name="configure" description="update external libraries">
    <update name="boost"/>
  </target>

  <target name="test" description="run unit tests">
    <build-test name="turtle" mode="all">
      <compilerarg value="-Wno-uninitialized" location="mid" if="is-cygwin"/>
    </build-test>
  </target>

  <target name="bench" description="run benchmark">
    <build-app name="turtle_bench" mode="all">
      <includepath path="${applications.dir}/turtle_bench"/>
    </build-app>
  </target>

  <target name="export" description="export the distribution">
    <deploy>
      <module name="turtle">
        <include name="**/*.hpp"/>
      </module>
    </deploy>
  </target>

  <target name="package" depends="export" description="package the distribution">
    <mkdir dir="${dist.dir}"/>
    <zip destfile="${dist.dir}/${ant.project.name}.zip" basedir="${dist.dir}" includes="include/**"/>
    <tar destfile="${dist.dir}/${ant.project.name}.tar.bz2" basedir="${dist.dir}" includes="include/**" compression="bzip2"/>
  </target>

  <target name="all" depends="configure,test,export,package" description="build, run tests and package application"/>

</project>
